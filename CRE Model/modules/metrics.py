import torch
from sklearn.model_selection import train_test_split
from sklearn.metrics import precision_recall_fscore_support, confusion_matrix


class Metrics_skl:
    def __init__(self, config):
        self.config = config


    def run_metrics(self, flat_labels, flat_preds, placeholder=''):
        '''
        this gets the current overall metrics for use during training
        NOTE: you need to use the labels parameter to exclude the placeholders
        NOTE: it doesn't matter if labels are repeated accross batches, this will not affect the results

        inputs:
            - aligned, cpu'd, numpy'd, flattened, filtered preds list
            - aligned, cpu'd, numpy'd, flattened, filtered labels list
            - params object

        outputs:
            - metrics dict
        '''
        support = len([x for x in flat_labels if x != placeholder])
        if support == 0:
            precision, recall, f1, support = 0,0,0,0
        else:
            #labels of interest are all the unique pos labels and preds (not the placeholders)
            classes_of_interest = list(set(flat_labels + flat_preds) - {placeholder})
            #Calculate metrics
            precision, recall, f1, _ = precision_recall_fscore_support(y_true  = flat_labels, 
                                                                       y_pred  = flat_preds, 
                                                                       labels  = classes_of_interest,    #only inlcude stats for actual labels + placeholder, if you dont do this, it include stats for FP in preds, they are already accounted for by the placeholder in labels
                                                                       average = self.config.f1_ave, 
                                                                       zero_division = 0)
        metrics = dict(support   = support,
                       precision = precision,
                       recall    = recall,
                       f1        = f1)
        #add the output metrics msg
        metrics['msg'] = f"S: {metrics['support']}\tP: {metrics['precision']:.2%}\tR: {metrics['recall']:.2%}\tF1: {metrics['f1']:.2%}\n"        
        return metrics



    def confusion_matrix(self, labels, preds, num_classes):
        """ Compute confusion matrix for list inputs. """
        preds = torch.tensor(preds)
        labels = torch.tensor(labels)
        k = (labels >= 0) & (labels < num_classes)
        return torch.bincount(num_classes * labels[k] + preds[k], minlength=num_classes**2).reshape(num_classes, num_classes)



    def print_confusion_matrix(self, cm, class_labels):
        """ Print the confusion matrix with headers and labels in the command line. """
        header = "Pred\\True" + ''.join(f"{label: >6}" for label in class_labels)
        print(header)
        for i, row in enumerate(cm):
            row_text = f"{class_labels[i]}      " + ' '.join(f"{val.item():5d}" for val in row)
            print(row_text)







class Metrics_custom:
    '''
    This just does the metric calc manually fixed to 'micro' averaging.
    NOTE: the labels and preds are lists of ONLY positive cases, no neg cases are included, i.e. for preds if a span was predicted as a nonetype, then it is not in the preds list here!!!
    '''
    def __init__(self, config):
        self.config = config



    def span_loose_matching(self, TP, FN, FP, tolerance=None, width_limit=None, make_binary=None):
        #Apply relaxed span matching for spans >10 words
        #keep the loose matched preds for later reference        
        matched_preds = set()  # Store already matched predictions to avoid double counting
        for label in list(FN):  
            l_start, l_end, l_type, batch_id = label 
            span_width = l_end - l_start
            for pred in [x for x in FP if x[-1] == batch_id]:
                p_start, p_end, p_type, p_batch_id = pred
                if (span_width >= width_limit and \
                    abs(l_start - p_start) <= tolerance and abs(l_end - p_end) <= tolerance if tolerance >= 1 else tolerance*span_width) and \
                   (True if make_binary else l_type == p_type):
                    # Match found, adjust sets
                    TP.add(label)
                    FN.remove(label)
                    FP.remove(pred)
                    matched_preds.add(pred)
                    break  # Stop once a match is found


    def rel_loose_matching(self, TP, FN, FP, tolerance=None, width_limit=None, make_binary=None):
        #Apply relaxed rel matching for spans >10 words
        #keep the loose matched preds for later reference        
        matched_preds = set()  # Store already matched predictions to avoid double counting
        for label in list(FN):  
            l_h_start, l_h_end, l_h_type, l_t_start, l_t_end, l_t_type, l_r_type, batch_id = label 
            h_span_width = l_h_end - l_h_start
            t_span_width = l_t_end - l_t_start
            for pred in [x for x in FP if x[-1] == batch_id]:
                p_h_start, p_h_end, p_h_type, p_t_start, p_t_end, p_t_type, p_r_type, p_batch_id = pred
                if ((h_span_width >= width_limit and \
                     abs(l_h_start - p_h_start) <= tolerance if tolerance >= 1 else tolerance*h_span_width and \
                     abs(l_h_end - p_h_end) <= tolerance if tolerance >= 1 else tolerance*h_span_width) and \
                    (t_span_width >= width_limit and \
                     abs(l_t_start - p_t_start) <= tolerance if tolerance >= 1 else tolerance*t_span_width and \
                     abs(l_t_end - p_t_end) <= tolerance if tolerance >= 1 else tolerance*t_span_width)) and \
                     (True if make_binary else (l_h_type == p_h_type and l_t_type == p_t_type and l_r_type == p_r_type)):
                    # Match found, adjust sets
                    TP.add(label)
                    FN.remove(label)
                    FP.remove(pred)
                    matched_preds.add(pred)
                    break  # Stop once a match is found


    def rel_mod_loose_matching(self, TP, FN, FP, tolerance=None, width_limit=None, make_binary=None):
        #Apply relaxed rel_mod matching for spans >10 words
        #keep the loose matched preds for later reference        
        matched_preds = set()  # Store already matched predictions to avoid double counting
        for label in list(FN):  
            l_h_start, l_h_end, l_t_start, l_t_end, l_r_type, batch_id = label 
            h_span_width = l_h_end - l_h_start
            t_span_width = l_t_end - l_t_start
            for pred in [x for x in FP if x[-1] == batch_id]:
                p_h_start, p_h_end, p_t_start, p_t_end, p_r_type, _ = pred
                if ((h_span_width >= width_limit and \
                     abs(l_h_start - p_h_start) <= tolerance if tolerance >= 1 else tolerance*h_span_width and \
                     abs(l_h_end - p_h_end) <= tolerance if tolerance >= 1 else tolerance*h_span_width) and \
                    (t_span_width >= width_limit and \
                     abs(l_t_start - p_t_start) <= tolerance if tolerance >= 1 else tolerance*t_span_width and \
                     abs(l_t_end - p_t_end) <= tolerance if tolerance >= 1 else tolerance*t_span_width)) and \
                     (True if make_binary else (l_r_type == p_r_type)):
                    # Match found, adjust sets
                    TP.add(label)
                    FN.remove(label)
                    FP.remove(pred)
                    matched_preds.add(pred)
                    break  # Stop once a match is found



    def calc_metrics(self, flat_labels, flat_preds, loose_matching=False, tolerance=None, span_limit=None, make_binary=None, type=None, **kwargs):
        '''
        This is for both spans and rels
        '''
        labels_set = set(flat_labels)
        preds_set = set(flat_preds)
        support = len(flat_labels)
        # Step 1: Find exact matches
        TP = labels_set & preds_set
        FN = labels_set - preds_set
        FP = preds_set - labels_set
        
        #do relaxed matching if requested
        if loose_matching:        
            if type == 'span':
                matched_preds = self.span_loose_matching(TP, FN, FP, tolerance=tolerance, width_limit=span_limit, make_binary=make_binary)
            elif type == 'rel':
                matched_preds = self.rel_loose_matching(TP, FN, FP, tolerance=tolerance, width_limit=span_limit, make_binary=make_binary)
            elif type == 'rel_mod':
                matched_preds = self.rel_mod_loose_matching(TP, FN, FP, tolerance=tolerance, width_limit=span_limit, make_binary=make_binary)

        #calc metrics
        TP = len(TP)
        FN = len(FN)
        FP = len(FP)
        #prec
        prec = TP / (TP + FP) if (TP + FP) > 0 else 0
        #rec
        rec = TP / (TP + FN) if (TP + FN) > 0 else 0
        #f1
        f1 = 2 * (prec * rec) / (prec + rec) if (prec + rec) > 0 else 0

        return prec, rec, f1, support



    def run_metrics(self, flat_labels, flat_preds, **kwargs):
        '''
        desc

        inputs:
            - cpu'd, numpy'd, flattened, labels list
            - cpu'd, numpy'd, flattened, preds list
            - params object

        outputs:
            - metrics dict
        '''
        if len(flat_labels) == 0:
            precision, recall, f1, support = 0,0,0,0
        else:
            #Calculate metrics
            precision, recall, f1, support = self.calc_metrics(flat_labels, flat_preds, **kwargs)

        metrics = dict(support   = support,
                       precision = precision,
                       recall    = recall,
                       f1        = f1)
        #add the output metrics msg
        metrics['msg'] = f"S: {metrics['support']}\tP: {metrics['precision']:.2%}\tR: {metrics['recall']:.2%}\tF1: {metrics['f1']:.2%}\n"        
        return metrics















###################################################################################3333
#testing
######################################################################################3
def test():
    # Example data where '' is used as a placeholder
    labels = [1, 2, 3, 4, '', '', '']
    preds = [1, '', 3, '', 6, 7, 8]

    #labels = ['(0, 3, 4, 0)', '(6, 8, 4, 0)', '(6, 10, 1, 1)', '(12, 14, 1, 1)', '(16, 18, 3, 1)', '(19, 22, 3, 1)', '(23, 26, 4, 1)', '(6, 8, 4, 2)', '(10, 13, 2, 2)', '(0, 4, 2, 3)', '(6, 8, 1, 3)', '(12, 14, 3, 3)', '(0, 3, 4, 4)', '(7, 8, 1, 4)', '(9, 10, 1, 4)', '(35, 39, 2, 4)', '(6, 8, 1, 5)', '(9, 10, 1, 5)', '(6, 10, 3, 6)', '(12, 13, 1, 6)', '(22, 23, 1, 6)', '(25, 27, 3, 6)', '(29, 30, 1, 6)', '(16, 18, 2, 7)', '(19, 21, 4, 7)', '(7, 10, 1, 8)', '(12, 13, 1, 8)', '(14, 15, 1, 8)', '(1, 2, 4, 9)', '(6, 7, 1, 9)', '(8, 10, 1, 9)', '(0, 1, 1, 10)', '(2, 4, 4, 10)', '(9, 10, 1, 10)', '(6, 8, 4, 11)', '(9, 10, 1, 11)', '(1, 3, 2, 12)', '(4, 5, 4, 12)', '(9, 10, 4, 12)', '(2, 4, 4, 13)', '(11, 13, 2, 13)', '(15, 17, 4, 14)', '(21, 22, 1, 14)', '(0, 1, 4, 15)', '(3, 4, 3, 15)', '(19, 20, 1, 15)', '(20, 21, 2, 15)', '(38, 39, 1, 15)', '(0, 4, 4, 16)', '(20, 23, 4, 16)', '(7, 9, 4, 17)', '(15, 17, 1, 17)', '(21, 25, 1, 17)', '(3, 4, 4, 18)', '(19, 20, 1, 18)', '(21, 23, 4, 18)', '(4, 7, 4, 19)', '(12, 15, 2, 19)', '(19, 20, 1, 19)', '(3, 4, 3, 20)', '(12, 14, 4, 20)', '(17, 22, 2, 20)']
    #preds = ['(0, 3, 2, 0)', '(6, 8, 2, 0)', '(1, 5, 1, 0)', '(1, 4, 2, 0)', '(0, 4, 1, 0)', '(2, 9, 1, 0)', '(1, 8, 1, 0)', '(0, 7, 1, 0)', '(1, 6, 4, 0)', '(10, 11, 2, 0)', '(3, 10, 1, 0)', '(1, 2, 4, 0)', '(8, 12, 1, 0)', '(2, 6, 1, 0)', '(3, 4, 2, 0)', '(2, 4, 2, 0)', '(1, 7, 1, 0)', '(0, 5, 4, 0)', '(5, 12, 1, 0)', '(3, 7, 1, 0)', '(2, 5, 2, 0)', '(7, 11, 1, 0)', '(4, 11, 2, 0)', '(2, 7, 2, 0)', '(9, 10, 2, 0)', '(9, 11, 2, 0)', '(6, 13, 2, 0)', '(8, 11, 2, 0)', '(3, 9, 1, 0)', '(0, 6, 1, 0)', '(1, 3, 2, 0)', '(2, 11, 1, 0)', '(1, 10, 1, 0)', '(3, 12, 1, 0)', '(6, 10, 1, 0)', '(1, 12, 1, 0)', '(3, 8, 4, 0)', '(7, 12, 4, 0)', '(6, 11, 4, 0)', '(2, 8, 1, 0)', '(8, 13, 4, 0)', '(9, 13, 1, 0)', '(6, 12, 1, 0)', '(2, 13, 2, 0)', '(5, 9, 1, 0)', '(8, 10, 2, 0)', '(0, 9, 1, 0)', '(5, 11, 1, 0)', '(5, 10, 4, 0)', '(0, 11, 1, 0)', '(3, 5, 2, 0)', '(4, 9, 4, 0)', '(9, 12, 2, 0)', '(10, 12, 2, 0)', '(7, 10, 2, 0)', '(7, 8, 4, 0)', '(1, 9, 1, 0)', '(4, 13, 2, 0)', '(7, 13, 1, 0)', '(4, 8, 1, 0)', '(4, 10, 1, 0)', '(1, 13, 1, 0)', '(1, 11, 1, 0)', '(0, 12, 1, 0)', '(6, 10, 1, 1)', '(12, 14, 4, 1)', '(16, 18, 4, 1)', '(19, 22, 4, 1)', '(23, 26, 4, 1)', '(24, 31, 1, 1)', '(22, 29, 1, 1)', '(21, 28, 1, 1)', '(21, 25, 1, 1)', '(25, 31, 1, 1)', '(21, 30, 1, 1)', '(20, 25, 4, 1)', '(7, 8, 4, 1)', '(29, 30, 4, 1)', '(20, 32, 1, 1)', '(2, 9, 4, 1)', '(4, 8, 1, 1)', '(17, 24, 4, 1)', '(22, 32, 1, 1)', '(27, 29, 2, 1)', '(19, 28, 1, 1)', '(7, 11, 1, 1)', '(11, 15, 1, 1)', '(18, 29, 4, 1)', '(23, 25, 4, 1)', '(20, 23, 4, 1)', '(10, 14, 1, 1)', '(6, 15, 1, 1)', '(22, 23, 4, 1)', '(18, 30, 1, 1)', '(1, 8, 2, 1)', '(17, 18, 4, 1)', '(24, 32, 1, 1)', '(28, 30, 4, 1)', '(23, 31, 1, 1)', '(5, 8, 4, 1)', '(22, 27, 4, 1)', '(19, 24, 4, 1)', '(20, 26, 4, 1)', '(8, 12, 1, 1)', '(5, 16, 4, 1)', '(14, 15, 4, 1)', '(9, 15, 1, 1)', '(2, 11, 4, 1)', '(3, 15, 1, 1)', '(8, 14, 1, 1)', '(15, 22, 2, 1)', '(28, 29, 4, 1)', '(9, 13, 1, 1)', '(4, 16, 1, 1)', '(6, 12, 1, 1)', '(10, 11, 4, 1)', '(0, 7, 2, 1)', '(17, 22, 4, 1)', '(5, 15, 1, 1)', '(21, 23, 4, 1)', '(16, 25, 4, 1)', '(11, 13, 2, 1)', '(8, 9, 4, 1)', '(4, 6, 2, 1)', '(13, 14, 4, 1)', '(24, 26, 2, 1)', '(31, 32, 4, 1)', '(12, 19, 1, 1)', '(6, 8, 4, 2)', '(10, 13, 4, 2)', '(6, 11, 4, 2)', '(5, 12, 1, 2)', '(6, 13, 2, 2)', '(8, 11, 4, 2)', '(7, 14, 2, 2)', '(7, 9, 4, 2)', '(5, 9, 1, 2)', '(8, 15, 2, 2)', '(8, 13, 4, 2)', '(7, 13, 2, 2)', '(5, 10, 4, 2)', '(1, 6, 4, 2)', '(15, 22, 4, 2)', '(24, 25, 2, 2)', '(6, 12, 1, 2)', '(20, 24, 1, 2)', '(20, 25, 4, 2)', '(17, 24, 4, 2)', '(14, 21, 4, 2)', '(22, 23, 2, 2)', '(7, 16, 2, 2)', '(4, 8, 1, 2)', '(19, 24, 4, 2)', '(0, 9, 2, 2)', '(1, 13, 1, 2)', '(0, 4, 1, 2)', '(22, 25, 2, 2)', '(0, 12, 1, 2)', '(18, 23, 4, 2)', '(2, 14, 1, 2)', '(15, 19, 1, 2)', '(4, 12, 4, 2)', '(6, 15, 1, 2)', '(17, 21, 1, 2)', '(5, 13, 4, 2)', '(9, 18, 1, 2)', '(3, 15, 1, 2)', '(5, 17, 1, 2)', '(7, 19, 1, 2)', '(22, 24, 2, 2)', '(18, 24, 1, 2)', '(8, 20, 1, 2)', '(9, 14, 4, 2)', '(17, 22, 4, 2)', '(1, 11, 3, 2)', '(13, 20, 2, 2)', '(0, 10, 3, 2)', '(6, 18, 1, 2)', '(9, 21, 1, 2)', '(14, 23, 4, 2)', '(5, 8, 4, 2)', '(20, 22, 2, 2)', '(12, 21, 4, 2)', '(14, 19, 4, 2)', '(10, 21, 4, 2)', '(0, 4, 1, 3)', '(6, 8, 2, 3)', '(12, 14, 2, 3)', '(5, 12, 2, 3)', '(4, 11, 1, 3)', '(3, 10, 1, 3)', '(1, 8, 1, 3)', '(2, 9, 1, 3)', '(6, 10, 1, 3)', '(6, 13, 2, 3)', '(1, 2, 4, 3)', '(7, 14, 2, 3)', '(1, 10, 1, 3)', '(0, 7, 1, 3)', '(6, 11, 4, 3)', '(8, 15, 2, 3)', '(1, 3, 2, 3)', '(1, 5, 1, 3)', '(1, 12, 1, 3)', '(6, 12, 1, 3)', '(5, 11, 1, 3)', '(3, 7, 1, 3)', '(4, 13, 1, 3)', '(5, 14, 2, 3)', '(1, 4, 2, 3)', '(7, 12, 4, 3)', '(3, 14, 2, 3)', '(3, 12, 1, 3)', '(1, 7, 1, 3)', '(2, 3, 4, 3)', '(7, 8, 4, 3)', '(2, 11, 1, 3)', '(2, 7, 4, 3)', '(4, 15, 2, 3)', '(3, 8, 4, 3)', '(0, 2, 4, 3)', '(0, 3, 4, 3)', '(1, 6, 4, 3)', '(6, 7, 4, 3)', '(6, 15, 2, 3)', '(8, 12, 1, 3)', '(2, 6, 1, 3)', '(7, 13, 1, 3)', '(7, 10, 2, 3)', '(1, 13, 1, 3)', '(5, 8, 2, 3)', '(0, 11, 1, 3)', '(8, 14, 2, 3)', '(2, 14, 1, 3)', '(4, 12, 4, 3)', '(0, 1, 4, 3)', '(3, 15, 1, 3)', '(1, 9, 4, 3)', '(11, 15, 1, 3)', '(0, 5, 4, 3)', '(2, 4, 2, 3)', '(2, 10, 4, 3)', '(8, 13, 3, 3)', '(1, 11, 1, 3)', '(5, 7, 2, 3)', '(4, 5, 4, 3)', '(9, 16, 2, 3)', '(4, 14, 2, 3)', '(0, 3, 4, 4)', '(7, 8, 4, 4)', '(9, 10, 4, 4)', '(35, 39, 1, 4)', '(27, 31, 1, 4)', '(26, 30, 1, 4)', '(2, 9, 1, 4)', '(34, 41, 1, 4)', '(26, 31, 4, 4)', '(25, 32, 1, 4)', '(6, 13, 1, 4)', '(14, 21, 1, 4)', '(28, 35, 4, 4)', '(9, 16, 1, 4)', '(34, 40, 1, 4)', '(17, 24, 1, 4)', '(25, 31, 1, 4)', '(16, 22, 1, 4)', '(34, 39, 4, 4)', '(28, 33, 4, 4)', '(5, 14, 1, 4)', '(36, 42, 1, 4)', '(10, 21, 1, 4)', '(24, 29, 4, 4)', '(10, 12, 3, 4)', '(13, 22, 1, 4)', '(8, 13, 4, 4)', '(24, 33, 1, 4)', '(9, 18, 1, 4)', '(3, 4, 4, 4)', '(20, 25, 1, 4)', '(13, 17, 1, 4)', '(5, 16, 1, 4)', '(27, 38, 4, 4)', '(28, 29, 4, 4)', '(7, 18, 1, 4)', '(10, 15, 1, 4)', '(8, 17, 1, 4)', '(33, 42, 1, 4)', '(27, 36, 1, 4)', '(4, 13, 1, 4)', '(6, 15, 1, 4)', '(19, 22, 2, 4)', '(16, 27, 1, 4)', '(18, 21, 3, 4)', '(5, 11, 1, 4)', '(7, 16, 1, 4)', '(17, 26, 1, 4)', '(19, 25, 1, 4)', '(5, 17, 1, 4)', '(18, 27, 1, 4)', '(6, 9, 4, 4)', '(9, 15, 1, 4)', '(6, 18, 1, 4)', '(2, 8, 1, 4)', '(0, 4, 1, 4)', '(11, 14, 4, 4)', '(4, 16, 1, 4)', '(22, 33, 4, 4)', '(0, 12, 1, 4)', '(36, 38, 4, 4)', '(27, 39, 1, 4)', '(31, 43, 1, 4)', '(33, 38, 4, 4)', '(6, 8, 4, 5)', '(9, 10, 4, 5)', '(15, 19, 1, 5)', '(2, 9, 1, 5)', '(16, 20, 1, 5)', '(3, 7, 1, 5)', '(15, 17, 4, 5)', '(14, 18, 1, 5)', '(16, 18, 4, 5)', '(14, 19, 4, 5)', '(13, 17, 1, 5)', '(8, 12, 1, 5)', '(3, 9, 1, 5)', '(7, 14, 1, 5)', '(16, 19, 4, 5)', '(5, 9, 1, 5)', '(2, 13, 1, 5)', '(4, 8, 1, 5)', '(15, 16, 4, 5)', '(11, 20, 1, 5)', '(15, 21, 1, 5)', '(12, 18, 1, 5)', '(4, 9, 4, 5)', '(13, 22, 1, 5)', '(5, 10, 4, 5)', '(2, 8, 1, 5)', '(6, 12, 1, 5)', '(8, 19, 1, 5)', '(14, 17, 4, 5)', '(7, 11, 1, 5)', '(7, 12, 1, 5)', '(17, 21, 1, 5)', '(0, 7, 1, 5)', '(12, 17, 4, 5)', '(11, 23, 1, 5)', '(4, 15, 1, 5)', '(11, 17, 1, 5)', '(18, 23, 4, 5)', '(2, 14, 1, 5)', '(6, 9, 4, 5)', '(8, 17, 1, 5)', '(3, 15, 1, 5)', '(7, 13, 1, 5)', '(4, 7, 4, 5)', '(6, 15, 1, 5)', '(8, 20, 1, 5)', '(3, 6, 4, 5)', '(6, 7, 4, 5)', '(20, 23, 4, 5)', '(1, 10, 1, 5)', '(5, 17, 1, 5)', '(11, 21, 1, 5)', '(7, 9, 4, 5)', '(12, 16, 1, 5)', '(10, 22, 1, 5)', '(11, 16, 4, 5)', '(9, 14, 4, 5)', '(1, 13, 1, 5)', '(11, 14, 4, 5)', '(12, 20, 4, 5)', '(12, 22, 1, 5)', '(2, 10, 1, 5)', '(21, 22, 4, 5)', '(0, 9, 1, 5)', '(6, 10, 1, 6)', '(12, 13, 4, 6)', '(22, 23, 4, 6)', '(25, 27, 4, 6)', '(29, 30, 4, 6)', '(17, 24, 4, 6)', '(18, 25, 1, 6)', '(16, 23, 1, 6)', '(15, 26, 1, 6)', '(14, 25, 1, 6)', '(20, 26, 1, 6)', '(16, 20, 1, 6)', '(13, 24, 1, 6)', '(20, 24, 1, 6)', '(19, 24, 4, 6)', '(20, 29, 1, 6)', '(19, 30, 1, 6)', '(18, 23, 4, 6)', '(16, 28, 1, 6)', '(12, 23, 1, 6)', '(15, 27, 1, 6)', '(16, 22, 1, 6)', '(11, 22, 1, 6)', '(17, 20, 4, 6)', '(19, 25, 1, 6)', '(21, 30, 1, 6)', '(14, 24, 1, 6)', '(16, 26, 1, 6)', '(21, 25, 1, 6)', '(17, 27, 1, 6)', '(18, 20, 4, 6)', '(18, 19, 4, 6)', '(10, 17, 1, 6)', '(10, 21, 1, 6)', '(13, 19, 1, 6)', '(18, 21, 4, 6)', '(19, 27, 1, 6)', '(20, 23, 4, 6)', '(19, 20, 4, 6)', '(13, 17, 1, 6)', '(17, 19, 4, 6)', '(8, 15, 1, 6)', '(13, 18, 4, 6)', '(12, 22, 1, 6)', '(13, 21, 1, 6)', '(17, 25, 4, 6)', '(22, 24, 4, 6)', '(8, 19, 1, 6)', '(9, 16, 1, 6)', '(21, 24, 4, 6)', '(2, 9, 1, 6)', '(3, 10, 1, 6)', '(7, 18, 1, 6)', '(26, 30, 1, 6)', '(9, 21, 1, 6)', '(14, 17, 4, 6)', '(11, 16, 4, 6)', '(5, 12, 1, 6)', '(14, 15, 4, 6)', '(25, 26, 4, 6)', '(7, 19, 1, 6)', '(25, 28, 4, 6)', '(4, 15, 1, 6)', '(27, 30, 4, 6)', '(16, 18, 4, 7)', '(19, 21, 4, 7)', '(11, 18, 1, 7)', '(8, 15, 1, 7)', '(1, 8, 1, 7)', '(3, 10, 1, 7)', '(14, 21, 1, 7)', '(4, 11, 1, 7)', '(13, 17, 1, 7)', '(7, 14, 1, 7)', '(12, 13, 4, 7)', '(15, 22, 1, 7)', '(14, 18, 1, 7)', '(18, 22, 1, 7)', '(17, 21, 1, 7)', '(4, 9, 4, 7)', '(2, 6, 1, 7)', '(1, 5, 1, 7)', '(10, 14, 1, 7)', '(6, 13, 1, 7)', '(15, 19, 1, 7)', '(4, 13, 1, 7)', '(17, 18, 4, 7)', '(9, 14, 4, 7)', '(10, 15, 4, 7)', '(14, 20, 1, 7)', '(8, 14, 1, 7)', '(3, 7, 1, 7)', '(13, 14, 4, 7)', '(12, 15, 4, 7)', '(9, 13, 1, 7)', '(16, 17, 4, 7)', '(8, 17, 1, 7)', '(13, 16, 4, 7)', '(13, 19, 1, 7)', '(7, 18, 1, 7)', '(9, 18, 1, 7)', '(8, 19, 1, 7)', '(7, 16, 1, 7)', '(1, 7, 1, 7)', '(8, 13, 4, 7)', '(9, 20, 1, 7)', '(3, 9, 1, 7)', '(5, 12, 1, 7)', '(19, 20, 4, 7)', '(16, 22, 1, 7)', '(6, 15, 1, 7)', '(4, 6, 4, 7)', '(2, 5, 4, 7)', '(14, 16, 4, 7)', '(8, 12, 1, 7)', '(4, 14, 1, 7)', '(3, 15, 1, 7)', '(20, 21, 4, 7)', '(0, 9, 1, 7)', '(5, 9, 1, 7)', '(5, 10, 4, 7)', '(7, 13, 1, 7)', '(8, 20, 1, 7)', '(3, 12, 1, 7)', '(15, 16, 4, 7)', '(11, 13, 4, 7)', '(9, 21, 1, 7)', '(7, 10, 4, 8)', '(12, 13, 4, 8)', '(14, 15, 4, 8)', '(17, 24, 1, 8)', '(19, 26, 1, 8)', '(16, 23, 1, 8)', '(15, 19, 1, 8)', '(10, 17, 1, 8)', '(16, 20, 1, 8)', '(14, 19, 1, 8)', '(20, 27, 1, 8)', '(12, 16, 1, 8)', '(22, 29, 1, 8)', '(10, 19, 1, 8)', '(18, 24, 1, 8)', '(12, 21, 1, 8)', '(12, 17, 4, 8)', '(20, 24, 1, 8)', '(10, 21, 1, 8)', '(13, 15, 4, 8)', '(14, 17, 1, 8)', '(17, 22, 1, 8)', '(12, 15, 4, 8)', '(11, 16, 4, 8)', '(3, 10, 1, 8)', '(19, 20, 4, 8)', '(16, 25, 1, 8)', '(16, 21, 1, 8)', '(1, 5, 1, 8)', '(15, 18, 1, 8)', '(16, 22, 1, 8)', '(11, 23, 1, 8)', '(23, 27, 1, 8)', '(20, 25, 4, 8)', '(9, 20, 1, 8)', '(6, 15, 1, 8)', '(14, 26, 1, 8)', '(15, 27, 1, 8)', '(20, 29, 1, 8)', '(17, 19, 3, 8)', '(10, 20, 1, 8)', '(18, 20, 3, 8)', '(24, 29, 4, 8)', '(21, 27, 1, 8)', '(9, 18, 1, 8)', '(0, 5, 4, 8)', '(12, 14, 4, 8)', '(3, 6, 4, 8)', '(6, 7, 4, 8)', '(14, 24, 1, 8)', '(13, 23, 1, 8)', '(23, 28, 4, 8)', '(9, 15, 1, 8)', '(22, 28, 1, 8)', '(4, 16, 1, 8)', '(14, 22, 1, 8)', '(1, 2, 4, 9)', '(8, 10, 2, 9)', '(3, 10, 1, 9)', '(5, 9, 1, 9)', '(6, 10, 1, 9)', '(2, 9, 1, 9)', '(4, 8, 1, 9)', '(1, 8, 1, 9)', '(3, 7, 1, 9)', '(6, 9, 2, 9)', '(7, 9, 2, 9)', '(5, 8, 2, 9)', '(0, 7, 2, 9)', '(8, 9, 2, 9)', '(7, 10, 2, 9)', '(5, 7, 2, 9)', '(4, 7, 2, 9)', '(5, 6, 4, 9)', '(3, 4, 4, 9)', '(2, 6, 1, 9)', '(4, 5, 2, 9)', '(0, 4, 1, 9)', '(3, 5, 2, 9)', '(2, 4, 2, 9)', '(4, 6, 2, 9)', '(3, 6, 2, 9)', '(0, 5, 4, 9)', '(1, 6, 4, 9)', '(2, 5, 2, 9)', '(1, 5, 1, 9)', '(2, 3, 4, 9)', '(0, 1, 2, 9)', '(1, 4, 4, 9)', '(0, 3, 2, 9)', '(0, 2, 2, 9)', '(1, 3, 2, 9)', '(0, 1, 4, 10)', '(2, 4, 4, 10)', '(9, 10, 4, 10)', '(25, 32, 1, 10)', '(25, 26, 4, 10)', '(13, 20, 4, 10)', '(13, 17, 1, 10)', '(29, 33, 1, 10)', '(21, 28, 1, 10)', '(9, 16, 1, 10)', '(28, 33, 4, 10)', '(13, 18, 4, 10)', '(8, 15, 1, 10)', '(2, 9, 1, 10)', '(23, 32, 1, 10)', '(5, 9, 1, 10)', '(26, 32, 1, 10)', '(26, 30, 1, 10)', '(1, 8, 1, 10)', '(25, 29, 1, 10)', '(22, 27, 4, 10)', '(13, 14, 4, 10)', '(25, 31, 1, 10)', '(15, 19, 1, 10)', '(23, 28, 4, 10)', '(13, 24, 4, 10)', '(12, 23, 4, 10)', '(24, 30, 1, 10)', '(22, 28, 1, 10)', '(6, 17, 1, 10)', '(1, 2, 4, 10)', '(11, 17, 1, 10)', '(13, 22, 4, 10)', '(24, 29, 4, 10)', '(21, 30, 1, 10)', '(21, 33, 1, 10)', '(20, 29, 1, 10)', '(32, 33, 4, 10)', '(18, 22, 1, 10)', '(5, 10, 4, 10)', '(6, 11, 4, 10)', '(13, 15, 4, 10)', '(7, 11, 1, 10)', '(16, 27, 4, 10)', '(9, 20, 4, 10)', '(1, 5, 1, 10)', '(30, 33, 4, 10)', '(5, 11, 1, 10)', '(29, 32, 4, 10)', '(17, 28, 4, 10)', '(22, 32, 1, 10)', '(20, 26, 1, 10)', '(9, 14, 1, 10)', '(1, 6, 4, 10)', '(12, 24, 4, 10)', '(28, 29, 4, 10)', '(29, 31, 4, 10)', '(9, 15, 1, 10)', '(1, 10, 1, 10)', '(8, 13, 1, 10)', '(2, 13, 1, 10)', '(15, 17, 4, 10)', '(23, 26, 4, 10)', '(24, 32, 4, 10)', '(6, 8, 4, 11)', '(9, 10, 4, 11)', '(13, 17, 1, 11)', '(13, 14, 4, 11)', '(5, 12, 1, 11)', '(13, 15, 2, 11)', '(7, 14, 1, 11)', '(11, 18, 1, 11)', '(10, 14, 1, 11)', '(14, 15, 4, 11)', '(12, 16, 1, 11)', '(9, 14, 4, 11)', '(4, 11, 1, 11)', '(8, 13, 4, 11)', '(10, 12, 4, 11)', '(12, 19, 1, 11)', '(10, 15, 4, 11)', '(14, 16, 4, 11)', '(6, 10, 1, 11)', '(14, 21, 1, 11)', '(12, 17, 4, 11)', '(13, 20, 1, 11)', '(13, 18, 4, 11)', '(10, 16, 1, 11)', '(4, 15, 1, 11)', '(8, 17, 1, 11)', '(6, 18, 1, 11)', '(17, 24, 1, 11)', '(5, 17, 1, 11)', '(16, 23, 1, 11)', '(9, 20, 1, 11)', '(7, 13, 1, 11)', '(5, 11, 1, 11)', '(4, 16, 1, 11)', '(15, 16, 4, 11)', '(23, 24, 4, 11)', '(4, 13, 1, 11)', '(15, 22, 1, 11)', '(1, 5, 1, 11)', '(3, 7, 1, 11)', '(3, 14, 1, 11)', '(0, 7, 1, 11)', '(11, 14, 4, 11)', '(14, 19, 4, 11)', '(13, 19, 1, 11)', '(16, 17, 4, 11)', '(5, 15, 1, 11)', '(6, 14, 1, 11)', '(9, 21, 1, 11)', '(3, 15, 1, 11)', '(8, 18, 1, 11)', '(11, 12, 4, 11)', '(15, 19, 1, 11)', '(14, 23, 1, 11)', '(14, 20, 1, 11)', '(9, 17, 4, 11)', '(1, 7, 1, 11)', '(10, 18, 1, 11)', '(19, 24, 4, 11)', '(7, 15, 1, 11)', '(1, 6, 4, 11)', '(16, 25, 1, 11)', '(19, 23, 1, 11)', '(3, 8, 1, 11)', '(1, 3, 3, 12)', '(4, 5, 4, 12)', '(4, 11, 1, 12)', '(0, 7, 1, 12)', '(7, 11, 1, 12)', '(3, 7, 1, 12)', '(4, 8, 1, 12)', '(1, 8, 1, 12)', '(6, 11, 4, 12)', '(3, 10, 1, 12)', '(1, 5, 1, 12)', '(5, 11, 1, 12)', '(0, 4, 1, 12)', '(2, 9, 1, 12)', '(2, 6, 1, 12)', '(5, 6, 4, 12)', '(4, 9, 4, 12)', '(5, 9, 1, 12)', '(1, 6, 1, 12)', '(0, 5, 3, 12)', '(8, 11, 4, 12)', '(0, 6, 1, 12)', '(3, 8, 1, 12)', '(1, 7, 1, 12)', '(2, 7, 3, 12)', '(6, 10, 1, 12)', '(6, 7, 4, 12)', '(10, 11, 4, 12)', '(4, 7, 4, 12)', '(2, 11, 1, 12)', '(9, 11, 4, 12)', '(4, 10, 1, 12)', '(5, 7, 3, 12)', '(3, 9, 1, 12)', '(0, 11, 1, 12)', '(0, 9, 1, 12)', '(3, 6, 2, 12)', '(5, 8, 4, 12)', '(0, 1, 2, 12)', '(4, 6, 3, 12)', '(2, 3, 2, 12)', '(5, 10, 4, 12)', '(7, 8, 4, 12)', '(0, 3, 2, 12)', '(2, 8, 1, 12)', '(8, 9, 4, 12)', '(6, 8, 3, 12)', '(3, 5, 2, 12)', '(1, 10, 1, 12)', '(3, 11, 1, 12)', '(2, 5, 2, 12)', '(1, 4, 2, 12)', '(2, 4, 2, 12)', '(3, 4, 2, 12)', '(6, 9, 4, 12)', '(8, 10, 4, 12)', '(1, 11, 1, 12)', '(0, 8, 1, 12)', '(7, 10, 4, 12)', '(1, 9, 1, 12)', '(7, 9, 2, 12)', '(0, 2, 3, 12)', '(1, 2, 4, 12)', '(2, 4, 2, 13)', '(11, 13, 3, 13)', '(4, 5, 4, 13)', '(6, 13, 1, 13)', '(1, 5, 1, 13)', '(3, 4, 4, 13)', '(2, 6, 1, 13)', '(9, 13, 1, 13)', '(0, 7, 1, 13)', '(2, 5, 4, 13)', '(6, 7, 4, 13)', '(3, 5, 3, 13)', '(1, 8, 1, 13)', '(3, 7, 1, 13)', '(5, 12, 1, 13)', '(1, 6, 4, 13)', '(4, 8, 1, 13)', '(2, 7, 3, 13)', '(2, 9, 1, 13)', '(4, 11, 1, 13)', '(0, 5, 4, 13)', '(1, 2, 4, 13)', '(0, 4, 1, 13)', '(8, 13, 4, 13)', '(10, 13, 4, 13)', '(2, 13, 1, 13)', '(0, 6, 1, 13)', '(12, 13, 4, 13)', '(3, 10, 1, 13)', '(4, 13, 1, 13)', '(1, 7, 1, 13)', '(3, 6, 4, 13)', '(7, 13, 1, 13)', '(4, 7, 3, 13)', '(5, 9, 1, 13)', '(2, 8, 1, 13)', '(3, 8, 3, 13)', '(5, 7, 3, 13)', '(4, 6, 3, 13)', '(11, 12, 4, 13)', '(6, 10, 1, 13)', '(6, 12, 1, 13)', '(6, 11, 4, 13)', '(1, 4, 4, 13)', '(8, 12, 1, 13)', '(5, 10, 4, 13)', '(5, 8, 4, 13)', '(5, 11, 1, 13)', '(1, 13, 1, 13)', '(4, 9, 3, 13)', '(7, 12, 4, 13)', '(5, 13, 1, 13)', '(2, 11, 1, 13)', '(3, 12, 1, 13)', '(4, 10, 1, 13)', '(1, 12, 1, 13)', '(1, 3, 4, 13)', '(3, 9, 1, 13)', '(0, 9, 1, 13)', '(7, 11, 1, 13)', '(6, 8, 4, 13)', '(10, 12, 3, 13)', '(15, 17, 3, 14)', '(21, 22, 4, 14)', '(8, 12, 1, 14)', '(3, 10, 1, 14)', '(7, 12, 4, 14)', '(7, 14, 1, 14)', '(8, 11, 4, 14)', '(7, 10, 4, 14)', '(5, 10, 4, 14)', '(16, 23, 1, 14)', '(15, 22, 1, 14)', '(17, 24, 1, 14)', '(8, 13, 4, 14)', '(12, 19, 1, 14)', '(9, 13, 1, 14)', '(9, 12, 4, 14)', '(18, 22, 1, 14)', '(16, 20, 1, 14)', '(1, 5, 1, 14)', '(10, 15, 4, 14)', '(3, 11, 4, 14)', '(3, 7, 1, 14)', '(22, 29, 1, 14)', '(4, 12, 4, 14)', '(1, 11, 4, 14)', '(1, 13, 1, 14)', '(11, 23, 1, 14)', '(12, 24, 1, 14)', '(11, 19, 4, 14)', '(15, 27, 1, 14)', '(0, 5, 4, 14)', '(20, 21, 4, 15)', '(22, 26, 1, 15)', '(21, 26, 1, 15)', '(23, 27, 1, 15)', '(6, 11, 1, 15)', '(23, 25, 3, 15)', '(3, 10, 1, 15)', '(19, 24, 1, 15)', '(15, 19, 1, 15)', '(7, 14, 1, 15)', '(22, 23, 1, 15)', '(29, 33, 1, 15)', '(2, 9, 1, 15)', '(16, 25, 1, 15)', '(25, 29, 1, 15)', '(5, 14, 1, 15)', '(14, 18, 1, 15)', '(5, 10, 4, 15)', '(5, 11, 1, 15)', '(7, 13, 1, 15)', '(28, 33, 4, 15)', '(8, 19, 1, 15)', '(11, 16, 1, 15)', '(14, 26, 1, 15)', '(19, 30, 1, 15)', '(10, 14, 1, 15)', '(30, 37, 1, 15)', '(17, 21, 1, 15)', '(20, 23, 4, 15)', '(21, 29, 1, 15)', '(6, 18, 1, 15)', '(11, 15, 1, 15)', '(12, 18, 1, 15)', '(5, 17, 1, 15)', '(4, 9, 4, 15)', '(27, 33, 1, 15)', '(10, 15, 1, 15)', '(5, 7, 4, 15)', '(12, 17, 4, 15)', '(13, 18, 1, 15)', '(7, 18, 1, 15)', '(26, 32, 1, 15)', '(12, 13, 4, 15)', '(18, 30, 1, 15)', '(15, 27, 1, 15)', '(7, 10, 4, 15)', '(30, 33, 4, 15)', '(11, 17, 1, 15)', '(16, 26, 1, 15)', '(26, 28, 4, 15)', '(10, 13, 1, 15)', '(6, 14, 1, 15)', '(18, 28, 1, 15)', '(14, 23, 1, 15)', '(31, 32, 4, 15)', '(15, 25, 1, 15)', '(19, 31, 1, 15)', '(9, 12, 1, 15)', '(0, 4, 1, 16)', '(20, 23, 4, 16)', '(1, 6, 4, 16)', '(1, 7, 1, 16)', '(3, 10, 1, 16)', '(5, 12, 1, 16)', '(5, 9, 1, 16)', '(10, 17, 1, 16)', '(1, 13, 1, 16)', '(4, 9, 3, 16)', '(6, 10, 1, 16)', '(2, 7, 4, 16)', '(5, 10, 4, 16)', '(1, 4, 2, 16)', '(6, 17, 1, 16)', '(3, 8, 4, 16)', '(7, 16, 1, 16)', '(1, 9, 1, 16)', '(0, 12, 1, 16)', '(13, 18, 1, 16)', '(9, 14, 1, 16)', '(4, 16, 1, 16)', '(4, 5, 4, 16)', '(10, 21, 1, 16)', '(14, 18, 1, 16)', '(6, 11, 1, 16)', '(8, 14, 1, 16)', '(6, 18, 1, 16)', '(0, 10, 1, 16)', '(5, 17, 1, 16)', '(9, 15, 1, 16)', '(7, 19, 1, 16)', '(0, 8, 1, 16)', '(2, 5, 4, 16)', '(16, 23, 1, 16)', '(11, 17, 1, 16)', '(28, 33, 4, 16)', '(6, 9, 2, 16)', '(17, 21, 1, 16)', '(2, 4, 2, 16)', '(2, 12, 1, 16)', '(13, 22, 1, 16)', '(7, 17, 1, 16)', '(26, 32, 1, 16)', '(28, 29, 4, 16)', '(10, 22, 1, 16)', '(6, 8, 2, 16)', '(16, 21, 3, 16)', '(11, 19, 1, 16)', '(9, 17, 1, 16)', '(17, 22, 4, 16)', '(19, 23, 1, 16)', '(15, 17, 3, 16)', '(8, 11, 1, 16)', '(16, 17, 3, 16)', '(12, 24, 1, 16)', '(0, 2, 2, 16)', '(9, 12, 4, 16)', '(27, 28, 4, 16)', '(24, 32, 1, 16)', '(15, 24, 1, 16)', '(7, 9, 4, 17)', '(15, 17, 2, 17)', '(21, 25, 1, 17)', '(7, 14, 1, 17)', '(17, 24, 4, 17)', '(6, 13, 1, 17)', '(9, 16, 1, 17)', '(17, 21, 1, 17)', '(13, 20, 1, 17)', '(16, 23, 4, 17)', '(10, 17, 1, 17)', '(9, 15, 1, 17)', '(8, 14, 1, 17)', '(13, 17, 1, 17)', '(20, 24, 1, 17)', '(8, 13, 4, 17)', '(16, 20, 1, 17)', '(7, 12, 4, 17)', '(11, 12, 4, 17)', '(13, 18, 4, 17)', '(6, 10, 1, 17)', '(6, 12, 1, 17)', '(13, 19, 1, 17)', '(16, 25, 4, 17)', '(9, 20, 1, 17)', '(7, 11, 1, 17)', '(19, 24, 4, 17)', '(13, 22, 1, 17)', '(7, 16, 1, 17)', '(7, 13, 1, 17)', '(14, 25, 4, 17)', '(15, 24, 1, 17)', '(11, 22, 4, 17)', '(14, 23, 1, 17)', '(11, 17, 1, 17)', '(4, 15, 1, 17)', '(15, 20, 4, 17)', '(22, 23, 4, 17)', '(5, 14, 1, 17)', '(17, 26, 4, 17)', '(23, 24, 4, 17)', '(3, 12, 1, 17)', '(15, 26, 4, 17)', '(9, 21, 1, 17)', '(4, 13, 1, 17)', '(22, 26, 1, 17)', '(5, 16, 1, 17)', '(9, 10, 4, 17)', '(7, 19, 1, 17)', '(8, 20, 1, 17)', '(16, 19, 4, 17)', '(17, 20, 4, 17)', '(3, 15, 1, 17)', '(14, 26, 1, 17)', '(14, 17, 4, 17)', '(11, 23, 1, 17)', '(18, 21, 4, 17)', '(20, 21, 4, 17)', '(17, 19, 4, 17)', '(5, 11, 1, 17)', '(4, 10, 1, 17)', '(13, 21, 4, 17)', '(6, 9, 4, 17)', '(12, 24, 1, 17)', '(3, 4, 4, 18)', '(19, 20, 4, 18)', '(21, 23, 2, 18)', '(15, 22, 1, 18)', '(2, 9, 1, 18)', '(5, 6, 4, 18)', '(20, 24, 1, 18)', '(5, 9, 1, 18)', '(2, 7, 1, 18)', '(1, 5, 1, 18)', '(18, 22, 1, 18)', '(6, 13, 1, 18)', '(3, 8, 4, 18)', '(14, 18, 1, 18)', '(15, 19, 1, 18)', '(4, 9, 1, 18)', '(17, 22, 4, 18)', '(2, 8, 1, 18)', '(17, 18, 4, 18)', '(3, 6, 4, 18)', '(14, 19, 4, 18)', '(3, 14, 1, 18)', '(5, 10, 4, 18)', '(1, 12, 1, 18)', '(2, 11, 1, 18)', '(1, 10, 1, 18)', '(13, 24, 1, 18)', '(17, 23, 1, 18)', '(3, 5, 4, 18)', '(5, 8, 4, 18)', '(2, 5, 4, 18)', '(5, 16, 1, 18)', '(20, 22, 2, 18)', '(0, 11, 1, 18)', '(4, 6, 4, 18)', '(6, 10, 1, 18)', '(2, 14, 1, 18)', '(14, 24, 1, 18)', '(10, 21, 1, 18)', '(0, 4, 1, 18)', '(20, 23, 2, 18)', '(12, 24, 1, 18)', '(3, 15, 1, 18)', '(18, 19, 4, 18)', '(17, 20, 2, 18)', '(4, 5, 4, 18)', '(10, 19, 1, 18)', '(16, 24, 1, 18)', '(4, 16, 1, 18)', '(7, 11, 1, 18)', '(0, 12, 1, 18)', '(14, 22, 4, 18)', '(13, 18, 4, 18)', '(5, 17, 1, 18)', '(6, 11, 4, 18)', '(10, 14, 1, 18)', '(8, 13, 4, 18)', '(15, 18, 2, 18)', '(7, 8, 4, 18)', '(15, 23, 1, 18)', '(8, 12, 1, 18)', '(6, 12, 1, 18)', '(4, 7, 1, 19)', '(12, 15, 2, 19)', '(19, 20, 4, 19)', '(7, 14, 1, 19)', '(14, 21, 1, 19)', '(1, 3, 3, 19)', '(12, 19, 1, 19)', '(15, 19, 1, 19)', '(6, 13, 1, 19)', '(13, 20, 1, 19)', '(9, 13, 1, 19)', '(3, 10, 1, 19)', '(0, 4, 1, 19)', '(15, 20, 1, 19)', '(15, 21, 1, 19)', '(10, 14, 1, 19)', '(16, 20, 1, 19)', '(14, 18, 1, 19)', '(18, 23, 1, 19)', '(15, 24, 1, 19)', '(19, 26, 1, 19)', '(2, 13, 1, 19)', '(1, 12, 1, 19)', '(8, 13, 1, 19)', '(9, 20, 1, 19)', '(14, 25, 1, 19)', '(9, 11, 2, 19)', '(16, 21, 1, 19)', '(9, 14, 1, 19)', '(13, 19, 1, 19)', '(3, 5, 3, 19)', '(13, 24, 1, 19)', '(2, 7, 1, 19)', '(17, 21, 1, 19)', '(0, 5, 1, 19)', '(10, 16, 1, 19)', '(12, 21, 1, 19)', '(11, 22, 1, 19)', '(9, 18, 1, 19)', '(1, 13, 1, 19)', '(18, 27, 1, 19)', '(6, 12, 1, 19)', '(16, 25, 1, 19)', '(20, 25, 1, 19)', '(14, 16, 2, 19)', '(6, 15, 1, 19)', '(16, 27, 1, 19)', '(21, 25, 1, 19)', '(15, 27, 1, 19)', '(20, 23, 1, 19)', '(8, 20, 1, 19)', '(9, 21, 1, 19)', '(5, 16, 1, 19)', '(6, 10, 1, 19)', '(17, 23, 1, 19)', '(22, 28, 1, 19)', '(22, 26, 1, 19)', '(2, 8, 1, 19)', '(23, 28, 1, 19)', '(18, 29, 1, 19)', '(10, 22, 1, 19)', '(4, 13, 1, 19)', '(17, 28, 1, 19)', '(15, 23, 1, 19)', '(3, 4, 4, 20)', '(12, 14, 3, 20)', '(17, 22, 4, 20)', '(1, 8, 1, 20)', '(15, 22, 1, 20)', '(2, 9, 1, 20)', '(6, 13, 1, 20)', '(14, 21, 1, 20)', '(3, 10, 1, 20)', '(13, 20, 1, 20)', '(4, 8, 1, 20)', '(2, 6, 1, 20)', '(12, 19, 1, 20)', '(15, 19, 1, 20)', '(1, 7, 1, 20)', '(2, 8, 1, 20)', '(7, 8, 4, 20)', '(1, 10, 1, 20)', '(4, 13, 1, 20)', '(2, 11, 1, 20)', '(0, 9, 1, 20)', '(6, 10, 1, 20)', '(5, 14, 1, 20)', '(4, 15, 1, 20)', '(3, 12, 1, 20)', '(5, 10, 4, 20)', '(11, 20, 1, 20)', '(7, 12, 4, 20)', '(11, 22, 1, 20)', '(4, 10, 1, 20)', '(7, 18, 1, 20)', '(3, 9, 1, 20)', '(5, 11, 1, 20)', '(6, 7, 4, 20)', '(2, 4, 4, 20)', '(5, 16, 1, 20)', '(6, 15, 1, 20)', '(6, 11, 4, 20)', '(1, 3, 4, 20)', '(6, 12, 1, 20)', '(17, 18, 4, 20)', '(6, 17, 1, 20)', '(3, 15, 1, 20)', '(16, 18, 3, 20)', '(12, 13, 4, 20)', '(12, 18, 1, 20)', '(9, 18, 1, 20)', '(7, 16, 1, 20)', '(12, 16, 1, 20)', '(13, 19, 1, 20)', '(15, 18, 4, 20)', '(6, 18, 1, 20)', '(5, 13, 1, 20)', '(0, 8, 1, 20)', '(6, 8, 4, 20)', '(3, 13, 1, 20)', '(4, 16, 1, 20)', '(19, 21, 1, 20)', '(13, 17, 1, 20)', '(7, 19, 1, 20)', '(1, 11, 1, 20)', '(11, 15, 1, 20)']

    #labels2 = [(0, 3, 4, 0), (6, 8, 4, 0), (6, 10, 1, 1), (12, 14, 1, 1), (16, 18, 3, 1), (19, 22, 3, 1), (23, 26, 4, 1), (6, 8, 4, 2), (10, 13, 2, 2), (0, 4, 2, 3), (6, 8, 1, 3), (12, 14, 3, 3), (0, 3, 4, 4), (7, 8, 1, 4), (9, 10, 1, 4), (35, 39, 2, 4), (6, 8, 1, 5), (9, 10, 1, 5), (6, 10, 3, 6), (12, 13, 1, 6), (22, 23, 1, 6), (25, 27, 3, 6), (29, 30, 1, 6), (16, 18, 2, 7), (19, 21, 4, 7), (7, 10, 1, 8), (12, 13, 1, 8), (14, 15, 1, 8), (1, 2, 4, 9), (6, 7, 1, 9), (8, 10, 1, 9), (0, 1, 1, 10), (2, 4, 4, 10), (9, 10, 1, 10), (6, 8, 4, 11), (9, 10, 1, 11), (1, 3, 2, 12), (4, 5, 4, 12), (9, 10, 4, 12), (2, 4, 4, 13), (11, 13, 2, 13), (15, 17, 4, 14), (21, 22, 1, 14), (0, 1, 4, 15), (3, 4, 3, 15), (19, 20, 1, 15), (20, 21, 2, 15), (38, 39, 1, 15), (0, 4, 4, 16), (20, 23, 4, 16), (7, 9, 4, 17), (15, 17, 1, 17), (21, 25, 1, 17), (3, 4, 4, 18), (19, 20, 1, 18), (21, 23, 4, 18), (4, 7, 4, 19), (12, 15, 2, 19), (19, 20, 1, 19), (3, 4, 3, 20), (12, 14, 4, 20), (17, 22, 2, 20)]
    #preds2 = [(0, 3, 2, 0), (6, 8, 2, 0), (1, 5, 1, 0), (1, 4, 2, 0), (0, 4, 1, 0), (2, 9, 1, 0), (1, 8, 1, 0), (0, 7, 1, 0), (1, 6, 4, 0), (10, 11, 2, 0), (3, 10, 1, 0), (1, 2, 4, 0), (8, 12, 1, 0), (2, 6, 1, 0), (3, 4, 2, 0), (2, 4, 2, 0), (1, 7, 1, 0), (0, 5, 4, 0), (5, 12, 1, 0), (3, 7, 1, 0), (2, 5, 2, 0), (7, 11, 1, 0), (4, 11, 2, 0), (2, 7, 2, 0), (9, 10, 2, 0), (9, 11, 2, 0), (6, 13, 2, 0), (8, 11, 2, 0), (3, 9, 1, 0), (0, 6, 1, 0), (1, 3, 2, 0), (2, 11, 1, 0), (1, 10, 1, 0), (3, 12, 1, 0), (6, 10, 1, 0), (1, 12, 1, 0), (3, 8, 4, 0), (7, 12, 4, 0), (6, 11, 4, 0), (2, 8, 1, 0), (8, 13, 4, 0), (9, 13, 1, 0), (6, 12, 1, 0), (2, 13, 2, 0), (5, 9, 1, 0), (8, 10, 2, 0), (0, 9, 1, 0), (5, 11, 1, 0), (5, 10, 4, 0), (0, 11, 1, 0), (3, 5, 2, 0), (4, 9, 4, 0), (9, 12, 2, 0), (10, 12, 2, 0), (7, 10, 2, 0), (7, 8, 4, 0), (1, 9, 1, 0), (4, 13, 2, 0), (7, 13, 1, 0), (4, 8, 1, 0), (4, 10, 1, 0), (1, 13, 1, 0), (1, 11, 1, 0), (0, 12, 1, 0), (6, 10, 1, 1), (12, 14, 4, 1), (16, 18, 4, 1), (19, 22, 4, 1), (23, 26, 4, 1), (24, 31, 1, 1), (22, 29, 1, 1), (21, 28, 1, 1), (21, 25, 1, 1), (25, 31, 1, 1), (21, 30, 1, 1), (20, 25, 4, 1), (7, 8, 4, 1), (29, 30, 4, 1), (20, 32, 1, 1), (2, 9, 4, 1), (4, 8, 1, 1), (17, 24, 4, 1), (22, 32, 1, 1), (27, 29, 2, 1), (19, 28, 1, 1), (7, 11, 1, 1), (11, 15, 1, 1), (18, 29, 4, 1), (23, 25, 4, 1), (20, 23, 4, 1), (10, 14, 1, 1), (6, 15, 1, 1), (22, 23, 4, 1), (18, 30, 1, 1), (1, 8, 2, 1), (17, 18, 4, 1), (24, 32, 1, 1), (28, 30, 4, 1), (23, 31, 1, 1), (5, 8, 4, 1), (22, 27, 4, 1), (19, 24, 4, 1), (20, 26, 4, 1), (8, 12, 1, 1), (5, 16, 4, 1), (14, 15, 4, 1), (9, 15, 1, 1), (2, 11, 4, 1), (3, 15, 1, 1), (8, 14, 1, 1), (15, 22, 2, 1), (28, 29, 4, 1), (9, 13, 1, 1), (4, 16, 1, 1), (6, 12, 1, 1), (10, 11, 4, 1), (0, 7, 2, 1), (17, 22, 4, 1), (5, 15, 1, 1), (21, 23, 4, 1), (16, 25, 4, 1), (11, 13, 2, 1), (8, 9, 4, 1), (4, 6, 2, 1), (13, 14, 4, 1), (24, 26, 2, 1), (31, 32, 4, 1), (12, 19, 1, 1), (6, 8, 4, 2), (10, 13, 4, 2), (6, 11, 4, 2), (5, 12, 1, 2), (6, 13, 2, 2), (8, 11, 4, 2), (7, 14, 2, 2), (7, 9, 4, 2), (5, 9, 1, 2), (8, 15, 2, 2), (8, 13, 4, 2), (7, 13, 2, 2), (5, 10, 4, 2), (1, 6, 4, 2), (15, 22, 4, 2), (24, 25, 2, 2), (6, 12, 1, 2), (20, 24, 1, 2), (20, 25, 4, 2), (17, 24, 4, 2), (14, 21, 4, 2), (22, 23, 2, 2), (7, 16, 2, 2), (4, 8, 1, 2), (19, 24, 4, 2), (0, 9, 2, 2), (1, 13, 1, 2), (0, 4, 1, 2), (22, 25, 2, 2), (0, 12, 1, 2), (18, 23, 4, 2), (2, 14, 1, 2), (15, 19, 1, 2), (4, 12, 4, 2), (6, 15, 1, 2), (17, 21, 1, 2), (5, 13, 4, 2), (9, 18, 1, 2), (3, 15, 1, 2), (5, 17, 1, 2), (7, 19, 1, 2), (22, 24, 2, 2), (18, 24, 1, 2), (8, 20, 1, 2), (9, 14, 4, 2), (17, 22, 4, 2), (1, 11, 3, 2), (13, 20, 2, 2), (0, 10, 3, 2), (6, 18, 1, 2), (9, 21, 1, 2), (14, 23, 4, 2), (5, 8, 4, 2), (20, 22, 2, 2), (12, 21, 4, 2), (14, 19, 4, 2), (10, 21, 4, 2), (0, 4, 1, 3), (6, 8, 2, 3), (12, 14, 2, 3), (5, 12, 2, 3), (4, 11, 1, 3), (3, 10, 1, 3), (1, 8, 1, 3), (2, 9, 1, 3), (6, 10, 1, 3), (6, 13, 2, 3), (1, 2, 4, 3), (7, 14, 2, 3), (1, 10, 1, 3), (0, 7, 1, 3), (6, 11, 4, 3), (8, 15, 2, 3), (1, 3, 2, 3), (1, 5, 1, 3), (1, 12, 1, 3), (6, 12, 1, 3), (5, 11, 1, 3), (3, 7, 1, 3), (4, 13, 1, 3), (5, 14, 2, 3), (1, 4, 2, 3), (7, 12, 4, 3), (3, 14, 2, 3), (3, 12, 1, 3), (1, 7, 1, 3), (2, 3, 4, 3), (7, 8, 4, 3), (2, 11, 1, 3), (2, 7, 4, 3), (4, 15, 2, 3), (3, 8, 4, 3), (0, 2, 4, 3), (0, 3, 4, 3), (1, 6, 4, 3), (6, 7, 4, 3), (6, 15, 2, 3), (8, 12, 1, 3), (2, 6, 1, 3), (7, 13, 1, 3), (7, 10, 2, 3), (1, 13, 1, 3), (5, 8, 2, 3), (0, 11, 1, 3), (8, 14, 2, 3), (2, 14, 1, 3), (4, 12, 4, 3), (0, 1, 4, 3), (3, 15, 1, 3), (1, 9, 4, 3), (11, 15, 1, 3), (0, 5, 4, 3), (2, 4, 2, 3), (2, 10, 4, 3), (8, 13, 3, 3), (1, 11, 1, 3), (5, 7, 2, 3), (4, 5, 4, 3), (9, 16, 2, 3), (4, 14, 2, 3), (0, 3, 4, 4), (7, 8, 4, 4), (9, 10, 4, 4), (35, 39, 1, 4), (27, 31, 1, 4), (26, 30, 1, 4), (2, 9, 1, 4), (34, 41, 1, 4), (26, 31, 4, 4), (25, 32, 1, 4), (6, 13, 1, 4), (14, 21, 1, 4), (28, 35, 4, 4), (9, 16, 1, 4), (34, 40, 1, 4), (17, 24, 1, 4), (25, 31, 1, 4), (16, 22, 1, 4), (34, 39, 4, 4), (28, 33, 4, 4), (5, 14, 1, 4), (36, 42, 1, 4), (10, 21, 1, 4), (24, 29, 4, 4), (10, 12, 3, 4), (13, 22, 1, 4), (8, 13, 4, 4), (24, 33, 1, 4), (9, 18, 1, 4), (3, 4, 4, 4), (20, 25, 1, 4), (13, 17, 1, 4), (5, 16, 1, 4), (27, 38, 4, 4), (28, 29, 4, 4), (7, 18, 1, 4), (10, 15, 1, 4), (8, 17, 1, 4), (33, 42, 1, 4), (27, 36, 1, 4), (4, 13, 1, 4), (6, 15, 1, 4), (19, 22, 2, 4), (16, 27, 1, 4), (18, 21, 3, 4), (5, 11, 1, 4), (7, 16, 1, 4), (17, 26, 1, 4), (19, 25, 1, 4), (5, 17, 1, 4), (18, 27, 1, 4), (6, 9, 4, 4), (9, 15, 1, 4), (6, 18, 1, 4), (2, 8, 1, 4), (0, 4, 1, 4), (11, 14, 4, 4), (4, 16, 1, 4), (22, 33, 4, 4), (0, 12, 1, 4), (36, 38, 4, 4), (27, 39, 1, 4), (31, 43, 1, 4), (33, 38, 4, 4), (6, 8, 4, 5), (9, 10, 4, 5), (15, 19, 1, 5), (2, 9, 1, 5), (16, 20, 1, 5), (3, 7, 1, 5), (15, 17, 4, 5), (14, 18, 1, 5), (16, 18, 4, 5), (14, 19, 4, 5), (13, 17, 1, 5), (8, 12, 1, 5), (3, 9, 1, 5), (7, 14, 1, 5), (16, 19, 4, 5), (5, 9, 1, 5), (2, 13, 1, 5), (4, 8, 1, 5), (15, 16, 4, 5), (11, 20, 1, 5), (15, 21, 1, 5), (12, 18, 1, 5), (4, 9, 4, 5), (13, 22, 1, 5), (5, 10, 4, 5), (2, 8, 1, 5), (6, 12, 1, 5), (8, 19, 1, 5), (14, 17, 4, 5), (7, 11, 1, 5), (7, 12, 1, 5), (17, 21, 1, 5), (0, 7, 1, 5), (12, 17, 4, 5), (11, 23, 1, 5), (4, 15, 1, 5), (11, 17, 1, 5), (18, 23, 4, 5), (2, 14, 1, 5), (6, 9, 4, 5), (8, 17, 1, 5), (3, 15, 1, 5), (7, 13, 1, 5), (4, 7, 4, 5), (6, 15, 1, 5), (8, 20, 1, 5), (3, 6, 4, 5), (6, 7, 4, 5), (20, 23, 4, 5), (1, 10, 1, 5), (5, 17, 1, 5), (11, 21, 1, 5), (7, 9, 4, 5), (12, 16, 1, 5), (10, 22, 1, 5), (11, 16, 4, 5), (9, 14, 4, 5), (1, 13, 1, 5), (11, 14, 4, 5), (12, 20, 4, 5), (12, 22, 1, 5), (2, 10, 1, 5), (21, 22, 4, 5), (0, 9, 1, 5), (6, 10, 1, 6), (12, 13, 4, 6), (22, 23, 4, 6), (25, 27, 4, 6), (29, 30, 4, 6), (17, 24, 4, 6), (18, 25, 1, 6), (16, 23, 1, 6), (15, 26, 1, 6), (14, 25, 1, 6), (20, 26, 1, 6), (16, 20, 1, 6), (13, 24, 1, 6), (20, 24, 1, 6), (19, 24, 4, 6), (20, 29, 1, 6), (19, 30, 1, 6), (18, 23, 4, 6), (16, 28, 1, 6), (12, 23, 1, 6), (15, 27, 1, 6), (16, 22, 1, 6), (11, 22, 1, 6), (17, 20, 4, 6), (19, 25, 1, 6), (21, 30, 1, 6), (14, 24, 1, 6), (16, 26, 1, 6), (21, 25, 1, 6), (17, 27, 1, 6), (18, 20, 4, 6), (18, 19, 4, 6), (10, 17, 1, 6), (10, 21, 1, 6), (13, 19, 1, 6), (18, 21, 4, 6), (19, 27, 1, 6), (20, 23, 4, 6), (19, 20, 4, 6), (13, 17, 1, 6), (17, 19, 4, 6), (8, 15, 1, 6), (13, 18, 4, 6), (12, 22, 1, 6), (13, 21, 1, 6), (17, 25, 4, 6), (22, 24, 4, 6), (8, 19, 1, 6), (9, 16, 1, 6), (21, 24, 4, 6), (2, 9, 1, 6), (3, 10, 1, 6), (7, 18, 1, 6), (26, 30, 1, 6), (9, 21, 1, 6), (14, 17, 4, 6), (11, 16, 4, 6), (5, 12, 1, 6), (14, 15, 4, 6), (25, 26, 4, 6), (7, 19, 1, 6), (25, 28, 4, 6), (4, 15, 1, 6), (27, 30, 4, 6), (16, 18, 4, 7), (19, 21, 4, 7), (11, 18, 1, 7), (8, 15, 1, 7), (1, 8, 1, 7), (3, 10, 1, 7), (14, 21, 1, 7), (4, 11, 1, 7), (13, 17, 1, 7), (7, 14, 1, 7), (12, 13, 4, 7), (15, 22, 1, 7), (14, 18, 1, 7), (18, 22, 1, 7), (17, 21, 1, 7), (4, 9, 4, 7), (2, 6, 1, 7), (1, 5, 1, 7), (10, 14, 1, 7), (6, 13, 1, 7), (15, 19, 1, 7), (4, 13, 1, 7), (17, 18, 4, 7), (9, 14, 4, 7), (10, 15, 4, 7), (14, 20, 1, 7), (8, 14, 1, 7), (3, 7, 1, 7), (13, 14, 4, 7), (12, 15, 4, 7), (9, 13, 1, 7), (16, 17, 4, 7), (8, 17, 1, 7), (13, 16, 4, 7), (13, 19, 1, 7), (7, 18, 1, 7), (9, 18, 1, 7), (8, 19, 1, 7), (7, 16, 1, 7), (1, 7, 1, 7), (8, 13, 4, 7), (9, 20, 1, 7), (3, 9, 1, 7), (5, 12, 1, 7), (19, 20, 4, 7), (16, 22, 1, 7), (6, 15, 1, 7), (4, 6, 4, 7), (2, 5, 4, 7), (14, 16, 4, 7), (8, 12, 1, 7), (4, 14, 1, 7), (3, 15, 1, 7), (20, 21, 4, 7), (0, 9, 1, 7), (5, 9, 1, 7), (5, 10, 4, 7), (7, 13, 1, 7), (8, 20, 1, 7), (3, 12, 1, 7), (15, 16, 4, 7), (11, 13, 4, 7), (9, 21, 1, 7), (7, 10, 4, 8), (12, 13, 4, 8), (14, 15, 4, 8), (17, 24, 1, 8), (19, 26, 1, 8), (16, 23, 1, 8), (15, 19, 1, 8), (10, 17, 1, 8), (16, 20, 1, 8), (14, 19, 1, 8), (20, 27, 1, 8), (12, 16, 1, 8), (22, 29, 1, 8), (10, 19, 1, 8), (18, 24, 1, 8), (12, 21, 1, 8), (12, 17, 4, 8), (20, 24, 1, 8), (10, 21, 1, 8), (13, 15, 4, 8), (14, 17, 1, 8), (17, 22, 1, 8), (12, 15, 4, 8), (11, 16, 4, 8), (3, 10, 1, 8), (19, 20, 4, 8), (16, 25, 1, 8), (16, 21, 1, 8), (1, 5, 1, 8), (15, 18, 1, 8), (16, 22, 1, 8), (11, 23, 1, 8), (23, 27, 1, 8), (20, 25, 4, 8), (9, 20, 1, 8), (6, 15, 1, 8), (14, 26, 1, 8), (15, 27, 1, 8), (20, 29, 1, 8), (17, 19, 3, 8), (10, 20, 1, 8), (18, 20, 3, 8), (24, 29, 4, 8), (21, 27, 1, 8), (9, 18, 1, 8), (0, 5, 4, 8), (12, 14, 4, 8), (3, 6, 4, 8), (6, 7, 4, 8), (14, 24, 1, 8), (13, 23, 1, 8), (23, 28, 4, 8), (9, 15, 1, 8), (22, 28, 1, 8), (4, 16, 1, 8), (14, 22, 1, 8), (1, 2, 4, 9), (8, 10, 2, 9), (3, 10, 1, 9), (5, 9, 1, 9), (6, 10, 1, 9), (2, 9, 1, 9), (4, 8, 1, 9), (1, 8, 1, 9), (3, 7, 1, 9), (6, 9, 2, 9), (7, 9, 2, 9), (5, 8, 2, 9), (0, 7, 2, 9), (8, 9, 2, 9), (7, 10, 2, 9), (5, 7, 2, 9), (4, 7, 2, 9), (5, 6, 4, 9), (3, 4, 4, 9), (2, 6, 1, 9), (4, 5, 2, 9), (0, 4, 1, 9), (3, 5, 2, 9), (2, 4, 2, 9), (4, 6, 2, 9), (3, 6, 2, 9), (0, 5, 4, 9), (1, 6, 4, 9), (2, 5, 2, 9), (1, 5, 1, 9), (2, 3, 4, 9), (0, 1, 2, 9), (1, 4, 4, 9), (0, 3, 2, 9), (0, 2, 2, 9), (1, 3, 2, 9), (0, 1, 4, 10), (2, 4, 4, 10), (9, 10, 4, 10), (25, 32, 1, 10), (25, 26, 4, 10), (13, 20, 4, 10), (13, 17, 1, 10), (29, 33, 1, 10), (21, 28, 1, 10), (9, 16, 1, 10), (28, 33, 4, 10), (13, 18, 4, 10), (8, 15, 1, 10), (2, 9, 1, 10), (23, 32, 1, 10), (5, 9, 1, 10), (26, 32, 1, 10), (26, 30, 1, 10), (1, 8, 1, 10), (25, 29, 1, 10), (22, 27, 4, 10), (13, 14, 4, 10), (25, 31, 1, 10), (15, 19, 1, 10), (23, 28, 4, 10), (13, 24, 4, 10), (12, 23, 4, 10), (24, 30, 1, 10), (22, 28, 1, 10), (6, 17, 1, 10), (1, 2, 4, 10), (11, 17, 1, 10), (13, 22, 4, 10), (24, 29, 4, 10), (21, 30, 1, 10), (21, 33, 1, 10), (20, 29, 1, 10), (32, 33, 4, 10), (18, 22, 1, 10), (5, 10, 4, 10), (6, 11, 4, 10), (13, 15, 4, 10), (7, 11, 1, 10), (16, 27, 4, 10), (9, 20, 4, 10), (1, 5, 1, 10), (30, 33, 4, 10), (5, 11, 1, 10), (29, 32, 4, 10), (17, 28, 4, 10), (22, 32, 1, 10), (20, 26, 1, 10), (9, 14, 1, 10), (1, 6, 4, 10), (12, 24, 4, 10), (28, 29, 4, 10), (29, 31, 4, 10), (9, 15, 1, 10), (1, 10, 1, 10), (8, 13, 1, 10), (2, 13, 1, 10), (15, 17, 4, 10), (23, 26, 4, 10), (24, 32, 4, 10), (6, 8, 4, 11), (9, 10, 4, 11), (13, 17, 1, 11), (13, 14, 4, 11), (5, 12, 1, 11), (13, 15, 2, 11), (7, 14, 1, 11), (11, 18, 1, 11), (10, 14, 1, 11), (14, 15, 4, 11), (12, 16, 1, 11), (9, 14, 4, 11), (4, 11, 1, 11), (8, 13, 4, 11), (10, 12, 4, 11), (12, 19, 1, 11), (10, 15, 4, 11), (14, 16, 4, 11), (6, 10, 1, 11), (14, 21, 1, 11), (12, 17, 4, 11), (13, 20, 1, 11), (13, 18, 4, 11), (10, 16, 1, 11), (4, 15, 1, 11), (8, 17, 1, 11), (6, 18, 1, 11), (17, 24, 1, 11), (5, 17, 1, 11), (16, 23, 1, 11), (9, 20, 1, 11), (7, 13, 1, 11), (5, 11, 1, 11), (4, 16, 1, 11), (15, 16, 4, 11), (23, 24, 4, 11), (4, 13, 1, 11), (15, 22, 1, 11), (1, 5, 1, 11), (3, 7, 1, 11), (3, 14, 1, 11), (0, 7, 1, 11), (11, 14, 4, 11), (14, 19, 4, 11), (13, 19, 1, 11), (16, 17, 4, 11), (5, 15, 1, 11), (6, 14, 1, 11), (9, 21, 1, 11), (3, 15, 1, 11), (8, 18, 1, 11), (11, 12, 4, 11), (15, 19, 1, 11), (14, 23, 1, 11), (14, 20, 1, 11), (9, 17, 4, 11), (1, 7, 1, 11), (10, 18, 1, 11), (19, 24, 4, 11), (7, 15, 1, 11), (1, 6, 4, 11), (16, 25, 1, 11), (19, 23, 1, 11), (3, 8, 1, 11), (1, 3, 3, 12), (4, 5, 4, 12), (4, 11, 1, 12), (0, 7, 1, 12), (7, 11, 1, 12), (3, 7, 1, 12), (4, 8, 1, 12), (1, 8, 1, 12), (6, 11, 4, 12), (3, 10, 1, 12), (1, 5, 1, 12), (5, 11, 1, 12), (0, 4, 1, 12), (2, 9, 1, 12), (2, 6, 1, 12), (5, 6, 4, 12), (4, 9, 4, 12), (5, 9, 1, 12), (1, 6, 1, 12), (0, 5, 3, 12), (8, 11, 4, 12), (0, 6, 1, 12), (3, 8, 1, 12), (1, 7, 1, 12), (2, 7, 3, 12), (6, 10, 1, 12), (6, 7, 4, 12), (10, 11, 4, 12), (4, 7, 4, 12), (2, 11, 1, 12), (9, 11, 4, 12), (4, 10, 1, 12), (5, 7, 3, 12), (3, 9, 1, 12), (0, 11, 1, 12), (0, 9, 1, 12), (3, 6, 2, 12), (5, 8, 4, 12), (0, 1, 2, 12), (4, 6, 3, 12), (2, 3, 2, 12), (5, 10, 4, 12), (7, 8, 4, 12), (0, 3, 2, 12), (2, 8, 1, 12), (8, 9, 4, 12), (6, 8, 3, 12), (3, 5, 2, 12), (1, 10, 1, 12), (3, 11, 1, 12), (2, 5, 2, 12), (1, 4, 2, 12), (2, 4, 2, 12), (3, 4, 2, 12), (6, 9, 4, 12), (8, 10, 4, 12), (1, 11, 1, 12), (0, 8, 1, 12), (7, 10, 4, 12), (1, 9, 1, 12), (7, 9, 2, 12), (0, 2, 3, 12), (1, 2, 4, 12), (2, 4, 2, 13), (11, 13, 3, 13), (4, 5, 4, 13), (6, 13, 1, 13), (1, 5, 1, 13), (3, 4, 4, 13), (2, 6, 1, 13), (9, 13, 1, 13), (0, 7, 1, 13), (2, 5, 4, 13), (6, 7, 4, 13), (3, 5, 3, 13), (1, 8, 1, 13), (3, 7, 1, 13), (5, 12, 1, 13), (1, 6, 4, 13), (4, 8, 1, 13), (2, 7, 3, 13), (2, 9, 1, 13), (4, 11, 1, 13), (0, 5, 4, 13), (1, 2, 4, 13), (0, 4, 1, 13), (8, 13, 4, 13), (10, 13, 4, 13), (2, 13, 1, 13), (0, 6, 1, 13), (12, 13, 4, 13), (3, 10, 1, 13), (4, 13, 1, 13), (1, 7, 1, 13), (3, 6, 4, 13), (7, 13, 1, 13), (4, 7, 3, 13), (5, 9, 1, 13), (2, 8, 1, 13), (3, 8, 3, 13), (5, 7, 3, 13), (4, 6, 3, 13), (11, 12, 4, 13), (6, 10, 1, 13), (6, 12, 1, 13), (6, 11, 4, 13), (1, 4, 4, 13), (8, 12, 1, 13), (5, 10, 4, 13), (5, 8, 4, 13), (5, 11, 1, 13), (1, 13, 1, 13), (4, 9, 3, 13), (7, 12, 4, 13), (5, 13, 1, 13), (2, 11, 1, 13), (3, 12, 1, 13), (4, 10, 1, 13), (1, 12, 1, 13), (1, 3, 4, 13), (3, 9, 1, 13), (0, 9, 1, 13), (7, 11, 1, 13), (6, 8, 4, 13), (10, 12, 3, 13), (15, 17, 3, 14), (21, 22, 4, 14), (8, 12, 1, 14), (3, 10, 1, 14), (7, 12, 4, 14), (7, 14, 1, 14), (8, 11, 4, 14), (7, 10, 4, 14), (5, 10, 4, 14), (16, 23, 1, 14), (15, 22, 1, 14), (17, 24, 1, 14), (8, 13, 4, 14), (12, 19, 1, 14), (9, 13, 1, 14), (9, 12, 4, 14), (18, 22, 1, 14), (16, 20, 1, 14), (1, 5, 1, 14), (10, 15, 4, 14), (3, 11, 4, 14), (3, 7, 1, 14), (22, 29, 1, 14), (4, 12, 4, 14), (1, 11, 4, 14), (1, 13, 1, 14), (11, 23, 1, 14), (12, 24, 1, 14), (11, 19, 4, 14), (15, 27, 1, 14), (0, 5, 4, 14), (20, 21, 4, 15), (22, 26, 1, 15), (21, 26, 1, 15), (23, 27, 1, 15), (6, 11, 1, 15), (23, 25, 3, 15), (3, 10, 1, 15), (19, 24, 1, 15), (15, 19, 1, 15), (7, 14, 1, 15), (22, 23, 1, 15), (29, 33, 1, 15), (2, 9, 1, 15), (16, 25, 1, 15), (25, 29, 1, 15), (5, 14, 1, 15), (14, 18, 1, 15), (5, 10, 4, 15), (5, 11, 1, 15), (7, 13, 1, 15), (28, 33, 4, 15), (8, 19, 1, 15), (11, 16, 1, 15), (14, 26, 1, 15), (19, 30, 1, 15), (10, 14, 1, 15), (30, 37, 1, 15), (17, 21, 1, 15), (20, 23, 4, 15), (21, 29, 1, 15), (6, 18, 1, 15), (11, 15, 1, 15), (12, 18, 1, 15), (5, 17, 1, 15), (4, 9, 4, 15), (27, 33, 1, 15), (10, 15, 1, 15), (5, 7, 4, 15), (12, 17, 4, 15), (13, 18, 1, 15), (7, 18, 1, 15), (26, 32, 1, 15), (12, 13, 4, 15), (18, 30, 1, 15), (15, 27, 1, 15), (7, 10, 4, 15), (30, 33, 4, 15), (11, 17, 1, 15), (16, 26, 1, 15), (26, 28, 4, 15), (10, 13, 1, 15), (6, 14, 1, 15), (18, 28, 1, 15), (14, 23, 1, 15), (31, 32, 4, 15), (15, 25, 1, 15), (19, 31, 1, 15), (9, 12, 1, 15), (0, 4, 1, 16), (20, 23, 4, 16), (1, 6, 4, 16), (1, 7, 1, 16), (3, 10, 1, 16), (5, 12, 1, 16), (5, 9, 1, 16), (10, 17, 1, 16), (1, 13, 1, 16), (4, 9, 3, 16), (6, 10, 1, 16), (2, 7, 4, 16), (5, 10, 4, 16), (1, 4, 2, 16), (6, 17, 1, 16), (3, 8, 4, 16), (7, 16, 1, 16), (1, 9, 1, 16), (0, 12, 1, 16), (13, 18, 1, 16), (9, 14, 1, 16), (4, 16, 1, 16), (4, 5, 4, 16), (10, 21, 1, 16), (14, 18, 1, 16), (6, 11, 1, 16), (8, 14, 1, 16), (6, 18, 1, 16), (0, 10, 1, 16), (5, 17, 1, 16), (9, 15, 1, 16), (7, 19, 1, 16), (0, 8, 1, 16), (2, 5, 4, 16), (16, 23, 1, 16), (11, 17, 1, 16), (28, 33, 4, 16), (6, 9, 2, 16), (17, 21, 1, 16), (2, 4, 2, 16), (2, 12, 1, 16), (13, 22, 1, 16), (7, 17, 1, 16), (26, 32, 1, 16), (28, 29, 4, 16), (10, 22, 1, 16), (6, 8, 2, 16), (16, 21, 3, 16), (11, 19, 1, 16), (9, 17, 1, 16), (17, 22, 4, 16), (19, 23, 1, 16), (15, 17, 3, 16), (8, 11, 1, 16), (16, 17, 3, 16), (12, 24, 1, 16), (0, 2, 2, 16), (9, 12, 4, 16), (27, 28, 4, 16), (24, 32, 1, 16), (15, 24, 1, 16), (7, 9, 4, 17), (15, 17, 2, 17), (21, 25, 1, 17), (7, 14, 1, 17), (17, 24, 4, 17), (6, 13, 1, 17), (9, 16, 1, 17), (17, 21, 1, 17), (13, 20, 1, 17), (16, 23, 4, 17), (10, 17, 1, 17), (9, 15, 1, 17), (8, 14, 1, 17), (13, 17, 1, 17), (20, 24, 1, 17), (8, 13, 4, 17), (16, 20, 1, 17), (7, 12, 4, 17), (11, 12, 4, 17), (13, 18, 4, 17), (6, 10, 1, 17), (6, 12, 1, 17), (13, 19, 1, 17), (16, 25, 4, 17), (9, 20, 1, 17), (7, 11, 1, 17), (19, 24, 4, 17), (13, 22, 1, 17), (7, 16, 1, 17), (7, 13, 1, 17), (14, 25, 4, 17), (15, 24, 1, 17), (11, 22, 4, 17), (14, 23, 1, 17), (11, 17, 1, 17), (4, 15, 1, 17), (15, 20, 4, 17), (22, 23, 4, 17), (5, 14, 1, 17), (17, 26, 4, 17), (23, 24, 4, 17), (3, 12, 1, 17), (15, 26, 4, 17), (9, 21, 1, 17), (4, 13, 1, 17), (22, 26, 1, 17), (5, 16, 1, 17), (9, 10, 4, 17), (7, 19, 1, 17), (8, 20, 1, 17), (16, 19, 4, 17), (17, 20, 4, 17), (3, 15, 1, 17), (14, 26, 1, 17), (14, 17, 4, 17), (11, 23, 1, 17), (18, 21, 4, 17), (20, 21, 4, 17), (17, 19, 4, 17), (5, 11, 1, 17), (4, 10, 1, 17), (13, 21, 4, 17), (6, 9, 4, 17), (12, 24, 1, 17), (3, 4, 4, 18), (19, 20, 4, 18), (21, 23, 2, 18), (15, 22, 1, 18), (2, 9, 1, 18), (5, 6, 4, 18), (20, 24, 1, 18), (5, 9, 1, 18), (2, 7, 1, 18), (1, 5, 1, 18), (18, 22, 1, 18), (6, 13, 1, 18), (3, 8, 4, 18), (14, 18, 1, 18), (15, 19, 1, 18), (4, 9, 1, 18), (17, 22, 4, 18), (2, 8, 1, 18), (17, 18, 4, 18), (3, 6, 4, 18), (14, 19, 4, 18), (3, 14, 1, 18), (5, 10, 4, 18), (1, 12, 1, 18), (2, 11, 1, 18), (1, 10, 1, 18), (13, 24, 1, 18), (17, 23, 1, 18), (3, 5, 4, 18), (5, 8, 4, 18), (2, 5, 4, 18), (5, 16, 1, 18), (20, 22, 2, 18), (0, 11, 1, 18), (4, 6, 4, 18), (6, 10, 1, 18), (2, 14, 1, 18), (14, 24, 1, 18), (10, 21, 1, 18), (0, 4, 1, 18), (20, 23, 2, 18), (12, 24, 1, 18), (3, 15, 1, 18), (18, 19, 4, 18), (17, 20, 2, 18), (4, 5, 4, 18), (10, 19, 1, 18), (16, 24, 1, 18), (4, 16, 1, 18), (7, 11, 1, 18), (0, 12, 1, 18), (14, 22, 4, 18), (13, 18, 4, 18), (5, 17, 1, 18), (6, 11, 4, 18), (10, 14, 1, 18), (8, 13, 4, 18), (15, 18, 2, 18), (7, 8, 4, 18), (15, 23, 1, 18), (8, 12, 1, 18), (6, 12, 1, 18), (4, 7, 1, 19), (12, 15, 2, 19), (19, 20, 4, 19), (7, 14, 1, 19), (14, 21, 1, 19), (1, 3, 3, 19), (12, 19, 1, 19), (15, 19, 1, 19), (6, 13, 1, 19), (13, 20, 1, 19), (9, 13, 1, 19), (3, 10, 1, 19), (0, 4, 1, 19), (15, 20, 1, 19), (15, 21, 1, 19), (10, 14, 1, 19), (16, 20, 1, 19), (14, 18, 1, 19), (18, 23, 1, 19), (15, 24, 1, 19), (19, 26, 1, 19), (2, 13, 1, 19), (1, 12, 1, 19), (8, 13, 1, 19), (9, 20, 1, 19), (14, 25, 1, 19), (9, 11, 2, 19), (16, 21, 1, 19), (9, 14, 1, 19), (13, 19, 1, 19), (3, 5, 3, 19), (13, 24, 1, 19), (2, 7, 1, 19), (17, 21, 1, 19), (0, 5, 1, 19), (10, 16, 1, 19), (12, 21, 1, 19), (11, 22, 1, 19), (9, 18, 1, 19), (1, 13, 1, 19), (18, 27, 1, 19), (6, 12, 1, 19), (16, 25, 1, 19), (20, 25, 1, 19), (14, 16, 2, 19), (6, 15, 1, 19), (16, 27, 1, 19), (21, 25, 1, 19), (15, 27, 1, 19), (20, 23, 1, 19), (8, 20, 1, 19), (9, 21, 1, 19), (5, 16, 1, 19), (6, 10, 1, 19), (17, 23, 1, 19), (22, 28, 1, 19), (22, 26, 1, 19), (2, 8, 1, 19), (23, 28, 1, 19), (18, 29, 1, 19), (10, 22, 1, 19), (4, 13, 1, 19), (17, 28, 1, 19), (15, 23, 1, 19), (3, 4, 4, 20), (12, 14, 3, 20), (17, 22, 4, 20), (1, 8, 1, 20), (15, 22, 1, 20), (2, 9, 1, 20), (6, 13, 1, 20), (14, 21, 1, 20), (3, 10, 1, 20), (13, 20, 1, 20), (4, 8, 1, 20), (2, 6, 1, 20), (12, 19, 1, 20), (15, 19, 1, 20), (1, 7, 1, 20), (2, 8, 1, 20), (7, 8, 4, 20), (1, 10, 1, 20), (4, 13, 1, 20), (2, 11, 1, 20), (0, 9, 1, 20), (6, 10, 1, 20), (5, 14, 1, 20), (4, 15, 1, 20), (3, 12, 1, 20), (5, 10, 4, 20), (11, 20, 1, 20), (7, 12, 4, 20), (11, 22, 1, 20), (4, 10, 1, 20), (7, 18, 1, 20), (3, 9, 1, 20), (5, 11, 1, 20), (6, 7, 4, 20), (2, 4, 4, 20), (5, 16, 1, 20), (6, 15, 1, 20), (6, 11, 4, 20), (1, 3, 4, 20), (6, 12, 1, 20), (17, 18, 4, 20), (6, 17, 1, 20), (3, 15, 1, 20), (16, 18, 3, 20), (12, 13, 4, 20), (12, 18, 1, 20), (9, 18, 1, 20), (7, 16, 1, 20), (12, 16, 1, 20), (13, 19, 1, 20), (15, 18, 4, 20), (6, 18, 1, 20), (5, 13, 1, 20), (0, 8, 1, 20), (6, 8, 4, 20), (3, 13, 1, 20), (4, 16, 1, 20), (19, 21, 1, 20), (13, 17, 1, 20), (7, 19, 1, 20), (1, 11, 1, 20), (11, 15, 1, 20)]      


    # Define which labels to calculate metrics for: all unique labels from `labels` and `preds` except 'x'
    unique_labels = list(set(labels + preds) - {''})

    # Calculate precision, recall, and f1-score
    precision, recall, f1, _ = precision_recall_fscore_support(labels, preds, labels=unique_labels, average='micro', zero_division='warn')

    print(f"Scikit-learn Precision: {precision:.2%}")
    print(f"Scikit-learn Recall: {recall:.2%}")
    print(f"Scikit-learn F1-Score: {f1:.2%}")


    # Manually calculating TP, FP, FN
    # Filter out 'x' which represents placeholders
    filtered_labels = [label for label in labels if label != '']
    filtered_preds = [pred for pred in preds if pred != '']
    TP = len([label for label in filtered_labels if label in filtered_preds])
    FP = len([pred for pred in filtered_preds if pred not in filtered_labels])
    FN = len([label for label in filtered_labels if label not in filtered_preds])
    # Calculate precision, recall, and f1 manually
    manual_precision = TP / (TP + FP) if TP + FP > 0 else 0
    manual_recall = TP / (TP + FN) if TP + FN > 0 else 0
    manual_f1 = 2 * (manual_precision * manual_recall) / (manual_precision + manual_recall) if manual_precision + manual_recall > 0 else 0

    print(f"Manual Precision: {manual_precision:.2%}")
    print(f"Manual Recall: {manual_recall:.2%}")
    print(f"Manual F1-Score: {manual_f1:.2%}")


    set_labels = set(filtered_labels)
    set_preds = set(filtered_preds)
    TP = len(set_labels & set_preds)
    FP = len(set_preds - set_labels)
    FN = len(set_labels - set_preds)

    # Calculate precision, recall, and f1 manually
    manual_precision = TP / (TP + FP) if TP + FP > 0 else 0
    manual_recall = TP / (TP + FN) if TP + FN > 0 else 0
    manual_f1 = 2 * (manual_precision * manual_recall) / (manual_precision + manual_recall) if manual_precision + manual_recall > 0 else 0

    print(f"Manual2 Precision: {manual_precision:.2%}")
    print(f"Manual2 Recall: {manual_recall:.2%}")
    print(f"Manual2 F1-Score: {manual_f1:.2%}")